<div class="flex w-full h-screen">
  <div class="overflow-x-auto w-full">
    <!-- Search Form -->
    <div class="form-inline mb-4 p-4 bg-base-200 rounded-lg">
      <%= search_form_for @q, local: true, class: "w-full" do |f| %>
        <div class="flex flex-wrap gap-2 mb-4">
          <%= f.search_field :email_cont, 
              placeholder: 'Search by email...', 
              class: 'input input-bordered input-sm flex-1 min-w-48' %>
          <%= f.search_field :sign_in_count_eq, 
              placeholder: 'Sign in count', 
              class: 'input input-bordered input-sm w-32' %>
        
          <div class="flex gap-2">
            <%= f.submit 'Search', class: 'btn btn-primary btn-sm' %>
            <%= link_to 'Clear', users_path, class: 'btn btn-ghost btn-sm' %>
          </div>
        </div>
      <% end %>
    </div>

  <!-- Users Table -->
  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>
          <%= sort_link(@q, :email, class: 'btn btn-ghost btn-xs') %>
        </th>
        <th>Created At</th>
        <th>
          <%= sort_link(@q, :sign_in_count, 'Sign In Count', class: 'btn btn-ghost btn-xs') %>
        </th>
        <th>Current Sign In At</th>
        <th>Last Sign In At</th>
        <th>Current Sign In IP</th>
        <th>Last Sign In IP</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr class="hover">
          <td><%= user.id %></td>
          <td>
            <div class="flex items-center gap-3">
              <div class="avatar placeholder">
                <div class="bg-neutral text-neutral-content rounded-full w-8">
                  <span class="text-xs"><%= user.email.first.upcase %></span>
                </div>
              </div>
              <div>
                <div class="font-bold"><%= user.email %></div>
              </div>
            </div>
          </td>
          <td>
            <span class="text-sm"><%= user.created_at.strftime("%b %d, %Y") if user.created_at %></span>
          </td>
          <td>
            <span class="badge badge-outline"><%= user.sign_in_count %></span>
          </td>
          <td>
            <span class="text-sm"><%= user.current_sign_in_at.strftime("%b %d, %Y %H:%M") if user.current_sign_in_at %></span>
          </td>
          <td>
            <span class="text-sm"><%= user.last_sign_in_at.strftime("%b %d, %Y %H:%M") if user.last_sign_in_at %></span>
          </td>
          <td>
            <span class="font-mono text-sm"><%= user.current_sign_in_ip %></span>
          </td>
          <td>
            <span class="font-mono text-sm"><%= user.last_sign_in_ip %></span>
          </td>
          <td>
            <button class="btn btn-ghost btn-xs">details</button>
          </td>
        </tr>
      <% end %>
    </tbody>
    <tfoot>
      <tr>
        <th>ID</th>
        <th>Email</th>
        <th>Created At</th>
        <th>Sign In Count</th>
        <th>Current Sign In At</th>
        <th>Last Sign In At</th>
        <th>Current Sign In IP</th>
        <th>Last Sign In IP</th>
        <th>Actions</th>
      </tr>
    </tfoot>
  </table>
</div>